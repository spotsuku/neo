<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®Œå…¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ - NEO Digital Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/auth.js"></script>
</head>
<body class="bg-gray-50 p-4">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">ğŸš€ NEO Platform å®Œå…¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ</h1>
        
        <!-- èªè¨¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="bg-white p-6 rounded-lg shadow mb-6">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-key mr-2 text-blue-600"></i>
                èªè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
            </h2>
            <div class="flex items-center justify-between">
                <div id="auth-status" class="text-gray-600">æœªãƒ­ã‚°ã‚¤ãƒ³</div>
                <button onclick="quickAdminLogin()" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                    ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³
                </button>
            </div>
        </div>

        <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- KPIèµ·ç‚¹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-lg font-semibold mb-4 flex items-center">
                    <i class="fas fa-chart-line mr-2 text-green-600"></i>
                    KPIèµ·ç‚¹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
                </h3>
                <div class="space-y-3">
                    <button onclick="testNavigation('dashboard')" class="w-full text-left p-3 border border-gray-200 rounded hover:bg-gray-50 transition-colors">
                        <div class="flex items-center justify-between">
                            <span>ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤º</span>
                            <i class="fas fa-external-link-alt text-gray-400"></i>
                        </div>
                    </button>
                    <button onclick="testNavigation('kpi-members')" class="w-full text-left p-3 border border-gray-200 rounded hover:bg-blue-50 transition-colors">
                        <div class="flex items-center justify-between">
                            <span>ğŸ‘¥ ä¼šå“¡ç·æ•°KPI â†’ å…¨ä¼šå“¡ä¸€è¦§</span>
                            <i class="fas fa-external-link-alt text-blue-400"></i>
                        </div>
                    </button>
                    <button onclick="testNavigation('kpi-atrisk')" class="w-full text-left p-3 border border-gray-200 rounded hover:bg-yellow-50 transition-colors">
                        <div class="flex items-center justify-between">
                            <span>âš ï¸ é›¢è„±äºˆå‚™è»KPI â†’ é›¢è„±äºˆå‚™è»ãƒ•ã‚£ãƒ«ã‚¿</span>
                            <i class="fas fa-external-link-alt text-yellow-400"></i>
                        </div>
                    </button>
                </div>
            </div>

            <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼èµ·ç‚¹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-lg font-semibold mb-4 flex items-center">
                    <i class="fas fa-bars mr-2 text-purple-600"></i>
                    ãƒ¡ãƒ‹ãƒ¥ãƒ¼èµ·ç‚¹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
                </h3>
                <div class="space-y-3">
                    <button onclick="testNavigation('menu-all')" class="w-full text-left p-3 border border-gray-200 rounded hover:bg-blue-50 transition-colors">
                        <div class="flex items-center justify-between">
                            <span>ğŸ“‹ ä¼šå“¡ç®¡ç† â†’ å…¨ä¼šå“¡ä¸€è¦§</span>
                            <i class="fas fa-external-link-alt text-blue-400"></i>
                        </div>
                    </button>
                    <button onclick="testNavigation('menu-active')" class="w-full text-left p-3 border border-gray-200 rounded hover:bg-green-50 transition-colors">
                        <div class="flex items-center justify-between">
                            <span>âœ… ä¼šå“¡ç®¡ç† â†’ ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ä¼šå“¡</span>
                            <i class="fas fa-external-link-alt text-green-400"></i>
                        </div>
                    </button>
                    <button onclick="testNavigation('menu-atrisk')" class="w-full text-left p-3 border border-gray-200 rounded hover:bg-yellow-50 transition-colors">
                        <div class="flex items-center justify-between">
                            <span>âš ï¸ ä¼šå“¡ç®¡ç† â†’ é›¢è„±äºˆå‚™è»</span>
                            <i class="fas fa-external-link-alt text-yellow-400"></i>
                        </div>
                    </button>
                    <button onclick="testNavigation('menu-csv')" class="w-full text-left p-3 border border-gray-200 rounded hover:bg-purple-50 transition-colors">
                        <div class="flex items-center justify-between">
                            <span>ğŸ“Š ä¼šå“¡ç®¡ç† â†’ CSVå‡ºåŠ›</span>
                            <i class="fas fa-external-link-alt text-purple-400"></i>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <!-- ãƒ‡ãƒ¼ã‚¿çµ±è¨ˆ -->
        <div class="bg-white p-6 rounded-lg shadow mb-6">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
                <i class="fas fa-chart-pie mr-2 text-indigo-600"></i>
                ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¼šå“¡çµ±è¨ˆ
            </h3>
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
                <div class="text-center p-3 bg-blue-50 rounded">
                    <div id="stat-total" class="text-2xl font-bold text-blue-700">-</div>
                    <div class="text-sm text-blue-600">ç·ä¼šå“¡æ•°</div>
                </div>
                <div class="text-center p-3 bg-green-50 rounded">
                    <div id="stat-active" class="text-2xl font-bold text-green-700">-</div>
                    <div class="text-sm text-green-600">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–</div>
                </div>
                <div class="text-center p-3 bg-yellow-50 rounded">
                    <div id="stat-atrisk" class="text-2xl font-bold text-yellow-700">-</div>
                    <div class="text-sm text-yellow-600">é›¢è„±äºˆå‚™è»</div>
                </div>
                <div class="text-center p-3 bg-purple-50 rounded">
                    <div id="stat-hero" class="text-2xl font-bold text-purple-700">-</div>
                    <div class="text-sm text-purple-600">ãƒ’ãƒ¼ãƒ­ãƒ¼èªå®š</div>
                </div>
                <div class="text-center p-3 bg-indigo-50 rounded">
                    <div id="stat-rate" class="text-2xl font-bold text-indigo-700">-</div>
                    <div class="text-sm text-indigo-600">èªå®šç‡</div>
                </div>
            </div>
        </div>

        <!-- ãƒ†ã‚¹ãƒˆãƒ­ã‚° -->
        <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
                <i class="fas fa-terminal mr-2 text-gray-600"></i>
                ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ­ã‚°
            </h3>
            <div id="test-log" class="bg-gray-900 text-green-400 p-4 rounded font-mono text-sm h-64 overflow-y-auto">
                <div>[SYSTEM] NEO Platform ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆæº–å‚™å®Œäº†</div>
                <div>[INFO] ã¾ãšã€Œç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³ã€ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„</div>
                <div>[INFO] ãã®å¾Œã€å„ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã‚’ãƒ†ã‚¹ãƒˆã§ãã¾ã™</div>
            </div>
        </div>
    </div>

    <script>
        function log(message, type = 'INFO') {
            const logElement = document.getElementById('test-log');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'ERROR' ? 'text-red-400' : type === 'SUCCESS' ? 'text-green-400' : type === 'WARN' ? 'text-yellow-400' : 'text-green-400';
            logElement.innerHTML += `<div class="${color}">[${timestamp}] [${type}] ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        function quickAdminLogin() {
            log('ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†é–‹å§‹');
            
            if (!window.authManager) {
                log('authManagerãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“', 'ERROR');
                return;
            }
            
            const result = window.authManager.quickLogin('admin@neo.com', 'password123');
            
            if (result.success) {
                log(`ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ: ${result.user.name}`, 'SUCCESS');
                document.getElementById('auth-status').innerHTML = `
                    <div class="flex items-center text-green-600">
                        <i class="fas fa-check-circle mr-2"></i>
                        ${result.user.name} (${result.user.role})
                    </div>
                `;
                loadMemberStats();
            } else {
                log(`ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—: ${result.message}`, 'ERROR');
            }
        }
        
        function testNavigation(type) {
            if (!checkAuth()) return;
            
            const urls = {
                'dashboard': '/admin-dashboard.html',
                'kpi-members': '/admin-members.html',
                'kpi-atrisk': '/admin-members.html?filter=at_risk',
                'menu-all': '/admin-members.html',
                'menu-active': '/admin-members.html?filter=active',
                'menu-atrisk': '/admin-members.html?filter=at_risk',
                'menu-csv': '/admin-members.html?action=csv_export'
            };
            
            const descriptions = {
                'dashboard': 'ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',
                'kpi-members': 'KPIçµŒç”±â†’å…¨ä¼šå“¡ä¸€è¦§',
                'kpi-atrisk': 'KPIçµŒç”±â†’é›¢è„±äºˆå‚™è»',
                'menu-all': 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼çµŒç”±â†’å…¨ä¼šå“¡ä¸€è¦§',
                'menu-active': 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼çµŒç”±â†’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ä¼šå“¡',
                'menu-atrisk': 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼çµŒç”±â†’é›¢è„±äºˆå‚™è»',
                'menu-csv': 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼çµŒç”±â†’CSVå‡ºåŠ›'
            };
            
            const url = urls[type];
            const description = descriptions[type];
            
            if (url) {
                log(`${description}ã«ãƒŠãƒ“ã‚²ãƒ¼ãƒˆ: ${url}`);
                setTimeout(() => {
                    window.open(url, '_blank');
                    log(`${description}ã®ãƒšãƒ¼ã‚¸ã‚’æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ãã¾ã—ãŸ`, 'SUCCESS');
                }, 500);
            } else {
                log(`æœªçŸ¥ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—: ${type}`, 'ERROR');
            }
        }
        
        function checkAuth() {
            if (!window.authManager || !window.authManager.getCurrentUser()) {
                log('ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ - å…ˆã«ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„', 'WARN');
                return false;
            }
            
            const user = window.authManager.getCurrentUser();
            if (user.role !== 'admin') {
                log('ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™', 'ERROR');
                return false;
            }
            
            return true;
        }
        
        function loadMemberStats() {
            log('ä¼šå“¡çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...');
            
            // ä¼šå“¡ãƒ‡ãƒ¼ã‚¿ã‚’å‹•çš„ã«èª­ã¿è¾¼ã¿
            const script = document.createElement('script');
            script.src = '/members.js';
            script.onload = function() {
                if (typeof demoMembers !== 'undefined') {
                    const total = demoMembers.length;
                    const active = demoMembers.filter(m => m.status === 'active').length;
                    const atRisk = demoMembers.filter(m => m.is_inactive_30d || m.status === 'inactive').length;
                    const heroCertified = demoMembers.filter(m => m.is_hero_certified).length;
                    const heroRate = ((heroCertified / total) * 100).toFixed(1);
                    
                    // çµ±è¨ˆè¡¨ç¤ºã‚’æ›´æ–°
                    document.getElementById('stat-total').textContent = total;
                    document.getElementById('stat-active').textContent = active;
                    document.getElementById('stat-atrisk').textContent = atRisk;
                    document.getElementById('stat-hero').textContent = heroCertified;
                    document.getElementById('stat-rate').textContent = heroRate + '%';
                    
                    log(`çµ±è¨ˆãƒ‡ãƒ¼ã‚¿æ›´æ–°å®Œäº†: ç·æ•°${total}, ã‚¢ã‚¯ãƒ†ã‚£ãƒ–${active}, é›¢è„±äºˆå‚™è»${atRisk}, ãƒ’ãƒ¼ãƒ­ãƒ¼èªå®š${heroCertified}å(${heroRate}%)`, 'SUCCESS');
                } else {
                    log('ä¼šå“¡ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—', 'ERROR');
                }
            };
            script.onerror = function() {
                log('members.jsã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼', 'ERROR');
            };
            document.head.appendChild(script);
        }
        
        // åˆæœŸåŒ–
        window.addEventListener('load', function() {
            log('NEO Platform å®Œå…¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆåˆæœŸåŒ–å®Œäº†', 'SUCCESS');
            log('ğŸ“‹ ãƒ†ã‚¹ãƒˆæ‰‹é †:');
            log('1. ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯');
            log('2. KPIèµ·ç‚¹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆ');
            log('3. ãƒ¡ãƒ‹ãƒ¥ãƒ¼èµ·ç‚¹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆ');
            log('4. å„ãƒšãƒ¼ã‚¸ã®å‹•ä½œã‚’ç¢ºèª');
        });
    </script>
</body>
</html>